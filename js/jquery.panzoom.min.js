(function(b,a){if(typeof define==="function"&&define.amd){define(["jquery"],function(c){return a(b,c);});}else{if(typeof exports==="object"){a(b,require("jquery"));
}else{a(b,b.jQuery);}}}(typeof window!=="undefined"?window:this,function(h,e){var t="over out down up move enter leave cancel".split(" ");var i=e.extend({},e.event.mouseHooks);
var c={};if(h.PointerEvent){e.each(t,function(x,w){e.event.fixHooks[(c[w]="pointer"+w)]=i;});}else{var f=i.props;i.props=f.concat(["touches","changedTouches","targetTouches","altKey","ctrlKey","metaKey","shiftKey"]);
i.filter=function(y,w){var z;var x=f.length;if(!w.pageX&&w.touches&&(z=w.touches[0])){while(x--){y[f[x]]=z[f[x]];}}return y;};e.each(t,function(x,w){if(x<2){c[w]="mouse"+w;
}else{var y="touch"+(w==="down"?"start":w==="up"?"end":w);e.event.fixHooks[y]=i;c[w]=y+" mouse"+w;}});}e.pointertouch=c;var m=h.document;var v="__pz__";
var o=Array.prototype.slice;var j=!!h.PointerEvent;var d=(function(){var w=m.createElement("input");w.setAttribute("oninput","return");return typeof w.oninput==="function";
})();var q=/([A-Z])/g;var k=/^http:[\w\.\/]+svg$/;var g=/^inline/;var l="(\\-?[\\d\\.e]+)";var p="\\,?\\s*";var u=new RegExp("^matrix\\("+l+p+l+p+l+p+l+p+l+p+l+"\\)$");
function r(y,w){var x=y.length;while(--x){if(+y[x]!==+w[x]){return false;}}return true;}function s(x){var w={range:true,animate:true};if(typeof x==="boolean"){w.animate=x;
}else{e.extend(w,x);}return w;}function n(E,D,C,B,A,z,y,x,w){if(e.type(E)==="array"){this.elements=[+E[0],+E[2],+E[4],+E[1],+E[3],+E[5],0,0,1];}else{this.elements=[E,D,C,B,A,z,y||0,x||0,w||1];
}}n.prototype={x:function(y){var z=y instanceof a;var x=this.elements,w=y.elements;if(z&&w.length===3){return new a(x[0]*w[0]+x[1]*w[1]+x[2]*w[2],x[3]*w[0]+x[4]*w[1]+x[5]*w[2],x[6]*w[0]+x[7]*w[1]+x[8]*w[2]);
}else{if(w.length===x.length){return new n(x[0]*w[0]+x[1]*w[3]+x[2]*w[6],x[0]*w[1]+x[1]*w[4]+x[2]*w[7],x[0]*w[2]+x[1]*w[5]+x[2]*w[8],x[3]*w[0]+x[4]*w[3]+x[5]*w[6],x[3]*w[1]+x[4]*w[4]+x[5]*w[7],x[3]*w[2]+x[4]*w[5]+x[5]*w[8],x[6]*w[0]+x[7]*w[3]+x[8]*w[6],x[6]*w[1]+x[7]*w[4]+x[8]*w[7],x[6]*w[2]+x[7]*w[5]+x[8]*w[8]);
}}return false;},inverse:function(){var x=1/this.determinant(),w=this.elements;return new n(x*(w[8]*w[4]-w[7]*w[5]),x*(-(w[8]*w[1]-w[7]*w[2])),x*(w[5]*w[1]-w[4]*w[2]),x*(-(w[8]*w[3]-w[6]*w[5])),x*(w[8]*w[0]-w[6]*w[2]),x*(-(w[5]*w[0]-w[3]*w[2])),x*(w[7]*w[3]-w[6]*w[4]),x*(-(w[7]*w[0]-w[6]*w[1])),x*(w[4]*w[0]-w[3]*w[1]));
},determinant:function(){var w=this.elements;return w[0]*(w[8]*w[4]-w[7]*w[5])-w[3]*(w[8]*w[1]-w[7]*w[2])+w[6]*(w[5]*w[1]-w[4]*w[2]);}};function a(w,B,A){this.elements=[w,B,A];
}a.prototype.e=n.prototype.e=function(w){return this.elements[w];};function b(A,y){if(!(this instanceof b)){return new b(A,y);}if(A.nodeType!==1){e.error("Panzoom called on non-Element node");
}if(!e.contains(m,A)){e.error("Panzoom element must be attached to the document");}var B=e.data(A,v);if(B){return B;}this.options=y=e.extend({},b.defaults,y);
this.elem=A;var x=this.$elem=e(A);this.$set=y.$set&&y.$set.length?y.$set:x;this.$doc=e(A.ownerDocument||m);this.$parent=x.parent();this.isSVG=k.test(A.namespaceURI)&&A.nodeName.toLowerCase()!=="svg";
this.panning=false;this._buildTransform();this._transform=!this.isSVG&&e.cssProps.transform.replace(q,"-$1").toLowerCase();this._buildTransition();this.resetDimensions();
var z=e();var w=this;e.each(["$zoomIn","$zoomOut","$zoomRange","$reset"],function(D,C){w[C]=y[C]||z;});this.enable();e.data(A,v,this);}b.rmatrix=u;b.events=e.pointertouch;
b.defaults={eventNamespace:".panzoom",transition:true,cursor:"move",disablePan:false,disableZoom:false,increment:0.3,minScale:0.4,maxScale:5,rangeStep:0.05,duration:200,easing:"ease-in-out",contain:false};
b.prototype={constructor:b,instance:function(){return this;},enable:function(){this._initStyle();this._bind();this.disabled=false;},disable:function(){this.disabled=true;
this._resetStyle();this._unbind();},isDisabled:function(){return this.disabled;},destroy:function(){this.disable();e.removeData(this.elem,v);},resetDimensions:function(){var z=this.$parent;
this.container={width:z.innerWidth(),height:z.innerHeight()};var x=z.offset();var y=this.elem;var w=this.$elem;var A;if(this.isSVG){A=y.getBoundingClientRect();
A={left:A.left-x.left,top:A.top-x.top,width:A.width,height:A.height,margin:{left:0,top:0}};}else{A={left:e.css(y,"left",true)||0,top:e.css(y,"top",true)||0,width:w.innerWidth(),height:w.innerHeight(),margin:{top:e.css(y,"marginTop",true)||0,left:e.css(y,"marginLeft",true)||0}};
}A.widthBorder=(e.css(y,"borderLeftWidth",true)+e.css(y,"borderRightWidth",true))||0;A.heightBorder=(e.css(y,"borderTopWidth",true)+e.css(y,"borderBottomWidth",true))||0;
this.dimensions=A;},reset:function(x){x=s(x);var w=this.setMatrix(this._origTransform,x);if(!x.silent){this._trigger("reset",w);}},resetZoom:function(x){x=s(x);
var w=this.getMatrix(this._origTransform);x.dValue=w[3];this.zoom(w[0],x);},resetPan:function(x){var w=this.getMatrix(this._origTransform);this.pan(w[4],w[5],s(x));
},setTransform:function(x){var z=this.isSVG?"attr":"style";var w=this.$set;var y=w.length;while(y--){e[z](w[y],"transform",x=="none"?"matrix(1,0,0,1,0,0)":x);
}},getTransform:function(x){var w=this.$set;var y=w[0];if(x){this.setTransform(x);}else{x=e[this.isSVG?"attr":"style"](y,"transform");}if(x!=="none"&&!u.test(x)){this.setTransform(x=e.css(y,"transform"));
}return x||"none";},getMatrix:function(x){var w=u.exec(x||this.getTransform());if(w){w.shift();}return w||[1,0,0,1,0,0];},setMatrix:function(F,K){if(this.disabled){return;
}if(!K){K={};}if(typeof F==="string"){F=this.getMatrix(F);}var G,w,J,C,H,B,y,E,x,I;var z=+F[0];var A=this.$parent;var D=typeof K.contain!=="undefined"?K.contain:this.options.contain;
if(D){G=this._checkDims();w=this.container;x=G.width+G.widthBorder;I=G.height+G.heightBorder;J=((x*Math.abs(z))-w.width)/2;C=((I*Math.abs(z))-w.height)/2;
y=G.left+G.margin.left;E=G.top+G.margin.top;if(D==="invert"){H=x>w.width?x-w.width:0;B=I>w.height?I-w.height:0;J+=(w.width-x)/2;C+=(w.height-I)/2;F[4]=Math.max(Math.min(F[4],J-y),-J-y-H);
F[5]=Math.max(Math.min(F[5],C-E),-C-E-B+G.heightBorder);}else{C+=G.heightBorder/2;H=w.width>x?w.width-x:0;B=w.height>I?w.height-I:0;if(A.css("textAlign")!=="center"||!g.test(e.css(this.elem,"display"))){J=C=0;
}else{H=0;}F[4]=Math.min(Math.max(F[4],J-y),-J-y+H);F[5]=Math.min(Math.max(F[5],C-E),-C-E+B);}}if(K.animate!=="skip"){this.transition(!K.animate);}if(K.range){this.$zoomRange.val(z);
}this.setTransform("matrix("+F.join(",")+")");if(!K.silent){this._trigger("change",F);}return F;},isPanning:function(){return this.panning;},transition:function(z){if(!this._transition){return;
}var y=z||!this.options.transition?"none":this._transition;var w=this.$set;var x=w.length;while(x--){if(e.style(w[x],"transition")!==y){e.style(w[x],"transition",y);
}}},pan:function(w,B,A){if(this.options.disablePan){return;}if(!A){A={};}var z=A.matrix;if(!z){z=this.getMatrix();}if(A.relative){w+=+z[4];B+=+z[5];}z[4]=w;
z[5]=B;this.setMatrix(z,A);if(!A.silent){this._trigger("pan",z[4],z[5]);}},zoom:function(D,w){if(typeof D==="object"){w=D;D=null;}else{if(!w){w={};}}var K=e.extend({},this.options,w);
if(K.disableZoom){return;}var z=false;var H=K.matrix||this.getMatrix();if(typeof D!=="number"){D=+H[0]+(K.increment*(D?-1:1));z=true;}if(D>K.maxScale){D=K.maxScale;
}else{if(D<K.minScale){D=K.minScale;}}var C=K.focal;if(C&&!K.disablePan){var I=this._checkDims();var y=C.clientX;var x=C.clientY;if(!this.isSVG){y-=(I.width+I.widthBorder)/2;
x-=(I.height+I.heightBorder)/2;}var B=new a(y,x,1);var F=new n(H);var A=this.parentOffset||this.$parent.offset();var J=new n(1,0,A.left-this.$doc.scrollLeft(),0,1,A.top-this.$doc.scrollTop());
var E=F.inverse().x(J.inverse().x(B));var G=D/H[0];F=F.x(new n([G,0,0,G,0,0]));B=J.x(F.x(E));H[4]=+H[4]+(y-B.e(0));H[5]=+H[5]+(x-B.e(1));}H[0]=D;H[3]=typeof K.dValue==="number"?K.dValue:D;
this.setMatrix(H,{animate:typeof K.animate==="boolean"?K.animate:z,range:!K.noSetRange});if(!K.silent){this._trigger("zoom",H[0],K);}},option:function(x,y){var w;
if(!x){return e.extend({},this.options);}if(typeof x==="string"){if(arguments.length===1){return this.options[x]!==undefined?this.options[x]:null;}w={};
w[x]=y;}else{w=x;}this._setOptions(w);},_setOptions:function(w){e.each(w,e.proxy(function(x,y){switch(x){case"disablePan":this._resetStyle();case"$zoomIn":case"$zoomOut":case"$zoomRange":case"$reset":case"disableZoom":case"onStart":case"onChange":case"onZoom":case"onPan":case"onEnd":case"onReset":case"eventNamespace":this._unbind();
}this.options[x]=y;switch(x){case"disablePan":this._initStyle();case"$zoomIn":case"$zoomOut":case"$zoomRange":case"$reset":this[x]=y;case"disableZoom":case"onStart":case"onChange":case"onZoom":case"onPan":case"onEnd":case"onReset":case"eventNamespace":this._bind();
break;case"cursor":e.style(this.elem,"cursor",y);break;case"minScale":this.$zoomRange.attr("min",y);break;case"maxScale":this.$zoomRange.attr("max",y);
break;case"rangeStep":this.$zoomRange.attr("step",y);break;case"startTransform":this._buildTransform();break;case"duration":case"easing":this._buildTransition();
case"transition":this.transition();break;case"$set":if(y instanceof e&&y.length){this.$set=y;this._initStyle();this._buildTransform();}}},this));},_initStyle:function(){var w={"backface-visibility":"hidden","transform-origin":this.isSVG?"0 0":"50% 50%"};
if(!this.options.disablePan){w.cursor=this.options.cursor;}this.$set.css(w);var x=this.$parent;if(x.length&&!e.nodeName(x[0],"body")){w={overflow:"hidden"};
if(x.css("position")==="static"){w.position="relative";}x.css(w);}},_resetStyle:function(){this.$elem.css({cursor:"",transition:""});this.$parent.css({overflow:"",position:""});
},_bind:function(){var E=this;var F=this.options;var z=F.eventNamespace;var C=j?"pointerdown"+z:("touchstart"+z+" mousedown"+z);var A=j?"pointerup"+z:("touchend"+z+" click"+z);
var D={};var x=this.$reset;var y=this.$zoomRange;e.each(["Start","Change","Zoom","Pan","End","Reset"],function(){var G=F["on"+this];if(e.isFunction(G)){D["panzoom"+this.toLowerCase()+z]=G;
}});if(!F.disablePan||!F.disableZoom){D[C]=function(H){var G;if(H.type==="touchstart"?(G=H.touches)&&((G.length===1&&!F.disablePan)||G.length===2):!F.disablePan&&H.which===1){H.preventDefault();
H.stopPropagation();E._startMove(H,G);}};}this.$elem.on(D);if(x.length){x.on(A,function(G){G.preventDefault();E.reset();});}if(y.length){y.attr({step:F.rangeStep===b.defaults.rangeStep&&y.attr("step")||F.rangeStep,min:F.minScale,max:F.maxScale}).prop({value:this.getMatrix()[0]});
}if(F.disableZoom){return;}var B=this.$zoomIn;var w=this.$zoomOut;if(B.length&&w.length){B.on(A,function(G){G.preventDefault();E.zoom();});w.on(A,function(G){G.preventDefault();
E.zoom(true);});}if(y.length){D={};D[(j?"pointerdown":"mousedown")+z]=function(){E.transition(true);};D[(d?"input":"change")+z]=function(){E.zoom(+this.value,{noSetRange:true});
};y.on(D);}},_unbind:function(){this.$elem.add(this.$zoomIn).add(this.$zoomOut).add(this.$reset).off(this.options.eventNamespace);},_buildTransform:function(){return this._origTransform=this.getTransform(this.options.startTransform);
},_buildTransition:function(){if(this._transform){var w=this.options;this._transition=this._transform+" "+w.duration+"ms "+w.easing;}},_checkDims:function(){var w=this.dimensions;
if(!w.width||!w.height){this.resetDimensions();}return this.dimensions;},_getDistance:function(y){var x=y[0];var w=y[1];return Math.sqrt(Math.pow(Math.abs(w.clientX-x.clientX),2)+Math.pow(Math.abs(w.clientY-x.clientY),2));
},_getMiddle:function(y){var x=y[0];var w=y[1];return{clientX:((w.clientX-x.clientX)/2)+x.clientX,clientY:((w.clientY-x.clientY)/2)+x.clientY};},_trigger:function(w){if(typeof w==="string"){w="panzoom"+w;
}this.$elem.triggerHandler(w,[this].concat(o.call(arguments,1)));},_startMove:function(H,A){var D,w,B,E,I,z,L,J;var C=this;var y=this.options;var N=y.eventNamespace;
var G=this.getMatrix();var F=G.slice(0);var M=+F[4];var K=+F[5];var x={matrix:G,animate:"skip"};if(j){w="pointermove";B="pointerup";}else{if(H.type==="touchstart"){w="touchmove";
B="touchend";}else{w="mousemove";B="mouseup";}}w+=N;B+=N;this.transition(true);this.panning=true;this._trigger("start",H,A);if(A&&A.length===2){E=this._getDistance(A);
I=+G[0];z=this._getMiddle(A);D=function(Q){Q.preventDefault();var O=C._getMiddle(A=Q.touches);var P=C._getDistance(A)-E;C.zoom(P*(y.increment/100)+I,{focal:O,matrix:G,animate:false});
C.pan(+G[4]+O.clientX-z.clientX,+G[5]+O.clientY-z.clientY,x);z=O;};}else{L=H.pageX;J=H.pageY;D=function(O){O.preventDefault();C.pan(M+O.pageX-L,K+O.pageY-J,x);
};}e(m).off(N).on(w,D).on(B,function(O){O.preventDefault();e(this).off(N);C.panning=false;O.type="panzoomend";C._trigger(O,G,!r(G,F));});}};e.Panzoom=b;
e.fn.panzoom=function(A){var x,z,w,y;if(typeof A==="string"){y=[];z=o.call(arguments,1);this.each(function(){x=e.data(this,v);if(!x){y.push(undefined);
}else{if(A.charAt(0)!=="_"&&typeof(w=x[A])==="function"&&(w=w.apply(x,z))!==undefined){y.push(w);}}});return y.length?(y.length===1?y[0]:y):this;}return this.each(function(){new b(this,A);
});};return b;}));